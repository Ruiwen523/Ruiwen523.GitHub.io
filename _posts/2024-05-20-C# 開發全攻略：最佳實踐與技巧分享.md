---
title: C# 開發全攻略：最佳實踐與技巧分享
author: ruiwen
date: 2024-05-20 14:00:00 +0800
last_modified_at: 2024-05-26 22:00:00 +0800
categories: [Blogging, Tutorial]
tags: [C#, 程式語言]
render_with_liquid: false
---

## 引言
在現代軟體開發領域中，選擇合適的程式語言至關重要。C# 作為一款由微軟開發並不斷優化的現代化程式語言，憑藉其強大的功能和靈活性，已經成為眾多開發者的首選。

### 為什麼選擇 C#    
  以下是幾個關鍵原因：
  - 強大且多樣的功能[^1]
  - 優秀的工具支持[^2]
  - 跨平台能力[^3]
  - 活躍的社群與豐富的資源[^4]
   
### 本文目的與內容概要
  - 降低程式開發者進入一門語言的難度
  - 本文涵蓋從基礎到進階的各種技術與最佳實踐
  - 幫助開發者提升程式設計能力與程式品質
  - 以有價值的資訊與實用的技巧為主

## C# 基礎知識
### 變數與資料型別
C# 中的變數和資料型別是理解程式語言的基礎。變數是存儲數據的容器，而資料型別則定義了變數可以存儲的數據種類。C# 支持多種資料型別，包括基本型別和引用型別。

**基本資料型別**：
- 整數型別：`int`, `long`, `short`, `byte`
- 浮點型別：`float`, `double`, `decimal`
- 字符型別：`char`
- 布爾型別：`bool`

**引用型別**：
- 字串型別：`string`
- 物件型別：`object`
- 陣列型別：`Array`
- 列表型別：`List<T>`

範例：
```csharp
int age = 30;
float height = 5.9f;
char initial = 'A';
bool isStudent = true;
string name = "John Smith";
List<string> names = new List<string> { "Alice", "Bob", "Charlie" };
```
> 其中變數宣告又有兩個主要類別，分別是[實值型別](https://learn.microsoft.com/zh-tw/dotnet/csharp/language-reference/builtin-types/value-types)與[參考型別](https://learn.microsoft.com/zh-tw/dotnet/csharp/language-reference/keywords/reference-types)，可點選文字超連結至微軟的學習官網查閱。
{: .prompt-tip }

### 常數與隱式類型變數
- 常數 `const`：用於定義在程序執行過程中不可更改的值。例如**物理常數**、**應用程式設定**、**網絡配置**、**文件路徑**、**時間**或**錯誤代碼**等。

``` csharp
// 數學常數
public class MathConstants
{
    public const double Pi = 3.14159;
    public const double EulerNumber = 2.71828;
}
// 應用程式設定
public class AppSettings
{
    public const string ApplicationName = "MyApp";        
    public const string Version = "1.0.0";
}
// 程式進入點
public class Program
{
    public static void Main()
    {
        // 計算圓周長
        double circleCircumference = 2 * MathConstants.Pi * 10;
        Console.WriteLine($"圓周長: {circleCircumference}");

        // 輸出應用程式設定
        Console.WriteLine($"Welcome to {AppSettings.ApplicationName}");
        Console.WriteLine($"Version: {AppSettings.Version}");

    }
}
```

> 使用常數宣告可以提高代碼的**可讀性、一致性和可維護性**。  
> 常數使得代碼更清晰明了，並有助於避免魔法數字[^5]和硬編碼[^6]。
{: .prompt-tip }

- 隱式類型變數 `var`：用於編譯時自動推斷變數的類型


``` csharp
const int MaxValue = 100;
var count = 10; // 編譯器將推斷 count 為 int 類型
```
### 枚舉型別 (`enum`)：
枚舉型別用於定義一組具名的整數常數，增加代碼的可讀性和可維護性。
``` csharp
public enum DaysOfWeek
{
    Sunday,
    Monday,
    Tuesday,
    Wednesday,
    Thursday,
    Friday,
    Saturday
}

public enum StatusCode
{
    Success = 200,
    NotFound = 404,
    InternalServerError = 500
}
```

### 基本語法與結構
C# 的基本語法和結構是編寫程式的核心。了解如何撰寫有效的 C# 程式碼對於開發者來說至關重要。
- 命名空間 `namespace`：  
  C# 使用命名空間來組織程式架構，避免名稱衝突，換言之命名空間是唯一的。
``` csharp
namespace MyApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            // 程式進入點
            Console.WriteLine("Hello, World!");
        }
    }
}
```

- 類別 `class` 和方法 `method`：  
  C# 是一個物件導向的語言，而類別（class）是其核心結構。
``` csharp
public class Person
{
    // 成員變數
    private string name;

    // 建構函數
    public Person(string name)
    {
        this.name = name;
    }

    // 方法
    public void Greet()
    {
        Console.WriteLine("Hello, my name is " + name);
    }
}
```


#### 控制結構（條件語句、迴圈等）
控制結構允許我們控制程式的流程，包括條件語句和迴圈。  

以下介紹條件語句 (`if-else`、`switch`) 和迴圈 (`for`、`while`、`do-while`) 的基本用法。

- **條件語句**：條件語句用於根據特定條件執行不同的代碼塊。
``` csharp
int number = 10;
if (number > 0)
{
    Console.WriteLine("Number is positive");
}
else if (number < 0)
{
    Console.WriteLine("Number is negative");
}
else
{
    Console.WriteLine("Number is zero");
}
```

- **迴圈**：迴圈允許我們重複執行某段代碼，直到特定條件為真。  
    ``` csharp
    // for 迴圈
    for (int i = 0; i < 10; i++)
    {
        Console.WriteLine(i);
    }

    // while 迴圈
    int j = 0;
    while (j < 10)
    {
        Console.WriteLine(j);
        j++;
    }

    // do-while 迴圈
    int k = 0;
    do
    {
        Console.WriteLine(k);
        k++;
    } while (k < 10);
    ```


## 物件導向程式設計
物件導向程式設計（OOP）是 C# 的核心理念之一。OOP 提供了一種組織和結構化程式碼的方式，使得代碼更加模組化、可重用和易於維護。本章將介紹 OOP 的三大基石：類別與物件、繼承與多型、介面與抽象類別。

### 類別與物件
類別是物件的藍圖或模板，定義了物件的屬性和行為。物件則是類別的實例，代表實際存在的實體。

- 定義類別：類別由關鍵字 `class` 定義，內部可以包含字段、屬性、方法和事件等成員。
``` csharp
public class Person
{
    // 字段
    private string name;
    private int age;

    // 屬性
    public string Name
    {
        get { return name; }
        set { name = value; }
    }

    public int Age
    {
        get { return age; }
        set { age = value; }
    }

    // 方法
    public void Greet()
    {
        Console.WriteLine($"Hello, my name is {name} and I am {age} years old.");
    }
}
```

- 創建物件：使用 `new` 關鍵字來創建類別的實例（物件）。
``` csharp
Person person = new Person();
person.Name = "Alice";
person.Age = 30;
person.Greet(); // 問候方法
```

### 繼承與多型
繼承允許我們從現有類別創建新類別，從而重用、擴展和修改父類別的行為。多型允許我們以統一的方式處理不同類別的對象。

- 繼承：使用 `:` 符號來繼承基類。
``` csharp
public class Employee : Person
{
    public int EmployeeID { get; set; }

    public void Work()
    {
        Console.WriteLine($"{Name} is working.");
    }
}
```

- 多型：通常通過基類引用來引用子類對象，並在運行時決定調用哪個方法實現。
``` csharp
Person employee = new Employee();
employee.Name = "Bob";
employee.Age = 25;
((Employee)employee).EmployeeID = 123;
employee.Greet();
((Employee)employee).Work();
```


### 介面與抽象類別
介面和抽象類別都是用來定義對象行為的工具，但它們有不同的用法和特性。

- 介面：只定義方法、屬性、事件或索引器的簽名，而不包含任何實現。類別或結構可以實現一個或多個介面。

``` csharp
public interface IWorkable
{
    void Work();
}

public class Manager : Person, IWorkable
{
    public void Work()
    {
        Console.WriteLine($"{Name} is managing the team.");
    }
}
```

- 抽象類別：可以包含抽象方法（沒有實現的方法）和具體方法。抽象類別不能實例化，必須被繼承。

``` csharp
public abstract class Animal
{
    public abstract void Speak();
}

public class Dog : Animal
{
    public override void Speak()
    {
        Console.WriteLine("Woof!");
    }
}

public class Program
{
    public static void Main()
    {
        Animal myDog = new Dog();
        myDog.Speak();
    }
}
```

## 小節
1. 物件導向程式設計提供了一種強大且靈活的方法來組織和管理代碼。
2. 通過理解和應用類別與物件、繼承與多型、介面與抽象類別的概念，開發者可以創建更高效、更可維護的程式碼。

## 進階語法特性
C# 提供了許多強大且靈活的語法特性，使得程式設計更加高效和便捷。本章將介紹三個重要的進階語法特性：委派與事件、屬性與索引器、泛型。

### 委派與事件
委派是 C# 中的一種型別安全的函數指標，允許將方法作為參數傳遞。事件則是基於委派的，主要用於實現事件驅動程式設計。

- 委派：用來定義可指向具有特定簽名和返回型別的方法的類型。

``` csharp
public delegate void Notify(string message);

public class Process
{
    public Notify ProcessCompleted;
    
    public void StartProcess()
    {
        Console.WriteLine("Process Started.");
        // 模擬一些處理工作
        OnProcessCompleted("Process Completed Successfully.");
    }

    protected virtual void OnProcessCompleted(string message)
    {
        ProcessCompleted?.Invoke(message);
    }
}

public class Program
{
    public static void Main()
    {
        Process process = new Process();
        process.ProcessCompleted = Message;
        process.StartProcess();
    }

    public static void Message(string message)
    {
        Console.WriteLine(message);
    }
}
```

- 事件：是基於委派的封裝，用於安全地發佈和訂閱消息。

``` csharp
public class Process
{
    public event EventHandler ProcessCompleted;

    public void StartProcess()
    {
        Console.WriteLine("Process Started.");
        // 模擬一些處理工作
        OnProcessCompleted(EventArgs.Empty);
    }

    protected virtual void OnProcessCompleted(EventArgs e)
    {
        ProcessCompleted?.Invoke(this, e);
    }
}

public class Program
{
    public static void Main()
    {
        Process process = new Process();
        process.ProcessCompleted += Process_ProcessCompleted;
        process.StartProcess();
    }

    private static void Process_ProcessCompleted(object sender, EventArgs e)
    {
        Console.WriteLine("Process Completed Successfully.");
    }
}
```

### 屬性與索引器
屬性提供了控制類別成員訪問的方法，而索引器允許對類似陣列的對象進行索引。

- 屬性：用於封裝字段的存取，並提供額外的邏輯。

``` csharp
public class Person
{
    private string name;
    private int age;

    public string Name
    {
        get { return name; }
        set { name = value; }
    }

    public int Age
    {
        get { return age; }
        set 
        { 
            if (value < 0)
                throw new ArgumentException("Age cannot be negative");
            age = value; 
        }
    }
}
```

- 索引器：允許對類似陣列的對象進行索引操作。

``` csharp
public class SampleCollection<T>
{
    private T[] arr = new T[100];
    public T this[int i]
    {
        get { return arr[i]; }
        set { arr[i] = value; }
    }
}

public class Program
{
    public static void Main()
    {
        var stringCollection = new SampleCollection<string>();
        stringCollection[0] = "Hello, World!";
        Console.WriteLine(stringCollection[0]);
    }
}
```


### 泛型
泛型允許你定義一個類別、結構、介面或方法，並在其中使用型別參數。這使得代碼更加通用和型別安全。

``` csharp
public class GenericList<T>
{
    private T[] elements;
    private int count;

    public GenericList(int capacity)
    {
        elements = new T[capacity];
        count = 0;
    }

    public void Add(T element)
    {
        if (count < elements.Length)
        {
            elements[count] = element;
            count++;
        }
        else
        {
            throw new InvalidOperationException("List is full");
        }
    }

    public T Get(int index)
    {
        if (index < 0 || index >= count)
        {
            throw new ArgumentOutOfRangeException(nameof(index));
        }
        return elements[index];
    }
}

public class Program
{
    public static void Main()
    {
        var intList = new GenericList<int>(5);
        intList.Add(1);
        intList.Add(2);
        Console.WriteLine(intList.Get(0)); // Output: 1
        Console.WriteLine(intList.Get(1)); // Output: 2

        var stringList = new GenericList<string>(5);
        stringList.Add("Hello");
        stringList.Add("World");
        Console.WriteLine(stringList.Get(0)); // Output: Hello
        Console.WriteLine(stringList.Get(1)); // Output: World
    }
}
```
## 小節
1. 進階語法特性使得 C# 成為一個強大且靈活的程式設計語言。
2. 通過理解和應用委派與事件、屬性與索引器、泛型等特性，開發者可以創建更加高效和可維護的代碼。

## 異步程式設計
異步程式設計在現代應用程式開發中扮演著越來越重要的角色。通過異步程式設計，可以提高應用程式的響應速度和資源利用率。本章將介紹異步與並行編程、`async` 和 `await` 關鍵字、以及 `Task` 和並行處理的相關知識和最佳實踐。

### 異步與並行編程
異步程式設計在現代應用程式開發中扮演著越來越重要的角色。通過異步程式設計，可以提高應用程式的響應速度和資源利用率。本章將介紹異步與並行編程、async 和 await 關鍵字、以及 Task 和並行處理的相關知識和最佳實踐。

- 異步與並行程式（Asynchronous Programming）：允許程序在等待某些操作（如 I/O 操作）完成時，不阻塞主執行緒，從而提高應用程式的響應速度。並行編程（Parallel Programming）則是同時執行多個任務，以提高計算效率。

``` csharp
public async Task DownloadFileAsync(string url)
{
    using (HttpClient client = new HttpClient())
    {
        string content = await client.GetStringAsync(url);
        Console.WriteLine(content);
    }
}

public async Task ProcessAsync()
{
    await DownloadFileAsync("https://example.com/file.txt");
    Console.WriteLine("Download completed.");
}
```

- 並行編程：允許在多核處理器上同時執行多個任務，從而提高計算效率。

``` csharp
public void ParallelProcessing()
{
    Parallel.For(0, 10, i =>
    {
        Console.WriteLine($"Processing {i}");
    });
}
```

### async 和 await 關鍵字
`async` 和 `await` 是 C# 中實現異步程式設計的核心關鍵字。`async` 用於標記一個方法為異步方法，`await` 用於等待異步操作的完成。

- async 關鍵字：用於修飾方法，表示該方法包含異步操作。

``` csharp
public async Task DoWorkAsync()
{
    await Task.Delay(1000); // 模擬異步操作
    Console.WriteLine("Work completed.");
}
```

### Task 和並行處理
`Task` 是 .NET 中表示異步操作的類。通過使用 `Task`，可以方便地實現並行處理和異步操作。

- Task 基本用法：`Task` 可以表示一個異步操作，並且可以使用 `Task.Run` 來啟動新任務。

``` csharp
public async Task RunTaskAsync()
{
    Task task = Task.Run(() =>
    {
        // 模擬一些計算操作
        for (int i = 0; i < 5; i++)
        {
            Console.WriteLine($"Task running: {i}");
            Thread.Sleep(1000);
        }
    });

    await task;
    Console.WriteLine("Task completed.");
}
```

- Task 並行處理：可以使用 `Task.WhenAll` 方法來等待多個任務完成，從而實現並行處理。

``` csharp
public async Task RunMultipleTasksAsync()
{
    Task task1 = Task.Run(() => 
    {
        Thread.Sleep(1000);
        Console.WriteLine("Task 1 completed.");
    });

    Task task2 = Task.Run(() => 
    {
        Thread.Sleep(2000);
        Console.WriteLine("Task 2 completed.");
    });

    await Task.WhenAll(task1, task2);
    Console.WriteLine("All tasks completed.");
}
```

### 小節
1. 異步程式設計是現代應用開發中的一個重要技術，它可以顯著提高應用的響應速度和資源利用率。
2. 通過理解和掌握異步與並行編程、`async` 和 `await` 關鍵字、以及 `Task` 和並行處理的用法，開發者可以編寫出更加高效和可靠的應用程式。

## LINQ（語言整合查詢）
LINQ（Language Integrated Query）是 C# 中的一個強大功能，允許開發者使用查詢語法來訪問和操作數據。LINQ 可以應用於多種數據源，如集合、數組、SQL 資料庫和 XML 文檔。本章將介紹 LINQ 的基礎概念、LINQ to Objects、LINQ to SQL 以及 LINQ to XML。

### LINQ 基礎
LINQ 提供了一套一致的語法來查詢不同類型的數據源，並且可以與 C# 語言無縫整合。LINQ 查詢由三個主要部分組成：數據來源、查詢語句和查詢執行。

- 基本語法
``` csharp
    // 數據來源
    int[] numbers = { 2, 4, 6, 8, 10 };

    // 查詢語句
    var evenNumbers = from num in numbers
                    where num % 2 == 0
                    select num;

    // 查詢執行
    foreach (var num in evenNumbers)
    {
        Console.WriteLine(num);
    }
```

- Lambda 表達式：LINQ 也可以使用 Lambda 表達式來簡化查詢語法。
``` csharp
    var evenNumbers = numbers.Where(num => num % 2 == 0);

    foreach (var num in evenNumbers)
    {
        Console.WriteLine(num);
    }
```

### LINQ to Objects
LINQ to Objects 允許對集合和數組等內存中的對象進行查詢操作。

- 查詢集合
``` csharp
    List<string> names = new List<string> { "Alice", "Bob", "Charlie", "David" };

    // 查詢語句
    var query = from name in names
                where name.StartsWith("A")
                select name;

    // 查詢執行
    foreach (var name in query)
    {
        Console.WriteLine(name);
    }
```

- 方法語法
``` csharp
    var query = names.Where(name => name.StartsWith("A"));

    foreach (var name in query)
    {
        Console.WriteLine(name);
    }
```

### LINQ to SQL 與 LINQ to XML

- LINQ to SQL：允許開發者使用 LINQ 查詢 SQL 資料庫，並且將結果映射到 C# 對象上
``` csharp
    using (var db = new DataContext(connectionString))
    {
        var query = from customer in db.GetTable<Customer>()
                    where customer.City == "Seattle"
                    select customer;

        foreach (var customer in query)
        {
            Console.WriteLine(customer.Name);
        }
    }
```

- LINQ to XML：提供了對 XML 文檔進行查詢和操作的功能。
``` csharp
    XDocument doc = XDocument.Load("books.xml");

    var query = from book in doc.Descendants("book")
                where (int)book.Element("price") > 20
                select new
                {
                    Title = book.Element("title").Value,
                    Price = book.Element("price").Value
                };

    foreach (var book in query)
    {
        Console.WriteLine($"Title: {book.Title}, Price: {book.Price}");
    }
```

### 小結
1. LINQ 是一個強大且靈活的工具，可以簡化數據查詢和操作過程。
2. 通過理解 LINQ 的基本語法、LINQ to Objects、LINQ to SQL 以及 LINQ to XML 的用法，開發者可以更高效地處理各種數據源。

## 資料操作
資料操作是任何應用程式開發中的關鍵部分。在 C# 中，有多種方法可以與資料庫進行互動，包括使用 ADO.NET 和 Entity Framework Core。本章將介紹如何使用 ADO.NET 進行資料庫操作、Entity Framework Core 的使用以及基本的 CRUD（創建、讀取、更新、刪除）操作。

### 使用 ADO.NET 進行資料庫操作
ADO.NET 是 .NET 提供的一套強大的資料訪問技術，允許開發者直接與資料庫進行互動。

1. 連接資料庫：首先，需要建立與資料庫的連接。這通常使用 `SqlConnection` 類來實現。
``` csharp
    string connectionString = "your_connection_string_here";

    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();
        Console.WriteLine("Database connected.");
    }
```
2. 執行查詢：可以使用 `SqlCommand` 類來執行 SQL 查詢。
``` csharp
    string query = "SELECT * FROM Customers";

    using (SqlCommand command = new SqlCommand(query, connection))
    {
        using (SqlDataReader reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine($"{reader["CustomerID"]}, {reader["Name"]}");
            }
        }
    }
```
3. 新增資料
``` csharp
   string insertQuery = "INSERT INTO Customers (Name, City) VALUES (@Name, @City)";

    using (SqlCommand command = new SqlCommand(insertQuery, connection))
    {
        command.Parameters.AddWithValue("@Name", "John Doe");
        command.Parameters.AddWithValue("@City", "New York");
        int rowsAffected = command.ExecuteNonQuery();
        Console.WriteLine($"{rowsAffected} row(s) inserted.");
    }
```

### Entity Framework Core
Entity Framework Core（EF Core）是一個開源的 ORM 框架，讓開發者可以使用 .NET 對象來操作資料庫，從而減少直接撰寫 SQL 語句的需要。

1. 配置與連接：首先，需要配置 EF Core 並建立與資料庫的連接。
``` csharp
    public class AppDbContext : DbContext
    {
        public DbSet<Customer> Customers { get; set; }

        protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
        {
            optionsBuilder.UseSqlServer("your_connection_string_here");
        }
    }
```
2. 定義實體類別
``` csharp
    public class Customer
    {
        public int CustomerID { get; set; }
        public string Name { get; set; }
        public string City { get; set; }
    }
```

### 基本 CRUD 操作
CRUD 操作是資料庫應用中最常見的操作，分別對應創建、讀取、更新和刪除資料。

- 創建（Create）
``` csharp
    using (var context = new AppDbContext())
    {
        var customer = new Customer { Name = "Jane Doe", City = "Los Angeles" };
        context.Customers.Add(customer);
        context.SaveChanges();
        Console.WriteLine("Customer added.");
    }
```
- 讀取（Read）
``` csharp
    using (var context = new AppDbContext())
    {
        var customers = context.Customers.ToList();
        foreach (var customer in customers)
        {
            Console.WriteLine($"{customer.CustomerID}, {customer.Name}, {customer.City}");
        }
    }
```
- 更新（Update）
``` csharp
    using (var context = new AppDbContext())
    {
        var customer = context.Customers.First();
        customer.City = "San Francisco";
        context.SaveChanges();
        Console.WriteLine("Customer updated.");
    }
```
- 刪除（Delete）
``` csharp
    using (var context = new AppDbContext())
    {
        var customer = context.Customers.First();
        context.Customers.Remove(customer);
        context.SaveChanges();
        Console.WriteLine("Customer deleted.");
    }
```

### 小結
1. 資料操作是應用程式開發的核心部分，掌握如何有效地進行資料庫操作對於開發者來說至關重要。
2. 使用 ADO.NET 可以進行細粒度的資料庫控制，而 Entity Framework Core 則提供了一種更高層次的抽象，讓資料操作更加簡單和高效。

## 例外處理與調試
在開發過程中，處理和調試錯誤是確保軟體穩定性和可靠性的關鍵步驟。本章將介紹錯誤處理的基礎概念、如何使用 `try-catch` 語句以及一些實用的調試技巧與工具。

### 錯誤處理基礎
錯誤處理是軟體開發中不可避免的一部分。在 C# 中，錯誤處理主要通過例外（Exception）機制來實現。例外是用來表示程序執行過程中發生的錯誤或異常情況的對象。

一些常見的例外類型包括：
- `ArgumentNullException`：當一個必需的參數為 null 時拋出。
- `ArgumentOutOfRangeException`：當一個參數的值超出有效範圍時拋出。
- `InvalidOperationException`：當方法調用的狀態不正確時拋出。
- `IOException`：當發生 I/O 操作錯誤時拋出。
``` csharp
public void ReadFile(string filePath)
{
    // 守衛語句
    if (string.IsNullOrEmpty(filePath))
    {
        throw new ArgumentNullException(nameof(filePath), 
            "File path cannot be null or empty");
    }

    // 讀取文件邏輯
}
```

### 使用 try-catch 語句
`try-catch` 語句用於捕獲和處理例外，從而避免程序崩潰並提供適當的錯誤處理機制。

#### 基本語法
``` csharp
    public void Divide(int numerator, int denominator)
    {
        try
        {
            int result = numerator / denominator;
            Console.WriteLine($"Result: {result}");
        }
        catch (DivideByZeroException ex)
        {
            Console.WriteLine("Error: Cannot divide by zero.");
            Console.WriteLine(ex.Message);
        }
    }
```

#### 多個 catch 區塊
可以使用多個 `catch` 塊來捕獲不同類型的例外。
``` csharp
public void ProcessFile(string filePath)
{
    try
    {
        string content = File.ReadAllText(filePath);
        Console.WriteLine(content);
    }
    catch (FileNotFoundException ex)
    {
        Console.WriteLine("Error: File not found.");
        Console.WriteLine(ex.Message);
    }
    catch (UnauthorizedAccessException ex)
    {
        Console.WriteLine("Error: Access denied.");
        Console.WriteLine(ex.Message);
    }
    catch (Exception ex)
    {
        Console.WriteLine("An unexpected error occurred.");
        Console.WriteLine(ex.Message);
    }
}
```

#### finally 塊
`finally` 塊中的代碼無論是否發生例外都會執行，通常用於釋放資源。
``` csharp
public void OpenFile(string filePath)
{
    FileStream fileStream = null;

    try
    {
        fileStream = File.Open(filePath, FileMode.Open);
        // 讀取文件
    }
    catch (Exception ex)
    {
        Console.WriteLine("An error occurred while opening the file.");
        Console.WriteLine(ex.Message);
    }
    finally
    {
        fileStream?.Dispose();
    }
}
```

### 調試技巧與工具
調試是開發過程中的重要環節，通過調試可以找出並修正代碼中的問題。Visual Studio 提供了強大的調試工具來幫助開發者進行代碼調試。

- 中斷點：是調試過程中的核心工具，用於暫停程式執行，讓開發者檢查變數值和程式狀態。
``` csharp
    public void Calculate(int value)
    {
        int result = value * 10; // 在這行設置中斷點 F8
        Console.WriteLine($"Result: {result}");
    }
```

- 監視窗口：允許開發者在調試過程中觀察和評估變數值。

- 即時窗口（Immediate Window）：允許在調試過程中執行代碼片段，檢查和修改變數值。
``` csharp
public void TestImmediateWindow()
{
    int a = 5;
    int b = 10;
    int sum = a + b; // 在這行設置斷點
    Console.WriteLine(sum); // 在即時窗口中可以評估和修改變數值
}
```

- 日誌記錄：可以幫助追蹤應用程式運行時的行為，特別是在生產環境中。
``` csharp
    private static readonly NLog.Logger Logger = NLog.LogManager.GetCurrentClassLogger();

    public void LogExample()
    {
        Logger.Info("This is an informational message.");
        Logger.Error("This is an error message.");
    }
```

## 小結
1. 有效的錯誤處理和調試技術對於開發穩定可靠的軟體至關重要。
2. 通過理解和應用錯誤處理的基礎概念、`try-catch` 語句以及調試技巧與工具，開發者可以更好地管理和排查代碼中的問題。

## 記憶體管理與垃圾回收
- C# 的記憶體管理
- 垃圾回收機制
- 使用 IDisposable 介面

## 設計模式
- 常見設計模式（如單例、工廠、觀察者）
- 在 C# 中的實現示例
- 設計模式的最佳實踐

## 測試與除錯
- 單元測試與測試框架（如 NUnit、MSTest）
- 測試驅動開發（TDD）
- 測試的最佳實踐

## 性能優化
- 性能分析工具
- 代碼優化技巧
- 常見性能問題及解決方案

## 安全性考量
- 常見安全威脅
- 安全編碼最佳實踐
- 使用加密與散列

## 部署與發佈
- 發佈策略
- 版本管理與部署工具
- 部署的最佳實踐

## 資源與進一步學習
- 推薦學習資源（書籍、網站、課程）
- 如何保持技術更新
- 加入 C# 社群

## 總結
- 回顧學習重點
- 鼓勵讀者進一步探索



### [附錄 A: 使用附錄額外編排一些內容]
額外內容與錨點[返回](#引言)

### 腳註
[^1]: **強大且多樣的功能**: C# 提供了豐富的語言特性，如異步編程、LINQ、泛型等，使得開發者能夠更加高效地編寫高性能和可維護的代碼。
[^2]: **優秀的工具支持**: Visual Studio 和 Visual Studio Code 等開發工具為 C# 提供了強大的編輯和調試支持，提升了開發者的工作效率。
[^3]: **跨平台能力**: 隨著 .NET Core 的推出，C# 逐漸實現了跨平台開發，能夠在 Windows、Linux 和 macOS 上運行。
[^4]: **活躍的社群與豐富的資源**: C# 擁有一個活躍的開發者社群，提供了大量的學習資源和開發支持，幫助新手快速入門並解決遇到的各種問題。
[^5]: **魔法數字（Magic Numbers）**是指在程式碼中直接使用的數字（或字串）常量，這些數字或字串沒有明確的說明其意圖或用途。它們使代碼難以理解和維護，因為它們的含義對讀者來說不明顯。
[^6]: **硬編碼（Hard Coding）**是指將數值、字串或其他固定資料直接寫入程式碼，而不是使用變數或常數來存儲這些值。硬編碼會使得代碼不靈活，修改這些值變得困難且容易出錯。
